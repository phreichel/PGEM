//*************************************************************************************************
package pgem.gui;
//*************************************************************************************************

import java.util.ArrayList;
import java.util.EnumSet;
import java.util.List;
import java.util.Set;

import javax.vecmath.Vector2f;

//*************************************************************************************************
public class Widget {

	//=============================================================================================
	private Widget parent = null;
	private final List<Widget> children = new ArrayList<>();
	private final Vector2f position = new Vector2f();
	private final Vector2f size = new Vector2f(800, 600);
	public final Dock dock = new Dock();
	public LayoutStyle layoutStyle = LayoutStyle.NONE;
	public final Set<RenderFlag> renderFlags = EnumSet.noneOf(RenderFlag.class);
	//=============================================================================================

	//=============================================================================================
	public Widget parent() {
		return parent;
	}
	//=============================================================================================

	//=============================================================================================
	public void parent(Widget parent) {
		if (this.parent == parent) return;
		if (this.parent != null) this.parent.children.remove(this);
		this.parent = parent;
		if (this.parent != null) this.parent.children.add(this);
	}
	//=============================================================================================
	
	//=============================================================================================
	public List<Widget> children() {
		return children;
	}
	//=============================================================================================
	
	//=============================================================================================
	public Vector2f position() {
		return position;
	}
	//=============================================================================================

	//=============================================================================================
	public void position(Vector2f position) {
		this.position.set(position);
	}
	//=============================================================================================
	
	//=============================================================================================
	public void position(float x, float y) {
		position.set(x, y);
	}
	//=============================================================================================
	
	//=============================================================================================
	public Vector2f size() {
		return size;
	}
	//=============================================================================================

	//=============================================================================================
	public void size(Vector2f size) {
		this.size(size.x, size.y);
	}
	//=============================================================================================
	
	//=============================================================================================
	public void size(float width, float height) {
		float dw = width - this.size.x;
		float dh = height - this.size.y;
		this.size.set(width, height);
		for (var c : this.children) {
			c.adjustSize(dw, dh);
		}
	}
	//=============================================================================================

	//=============================================================================================
	private void adjustSize(float dw, float dh) {
		float nx = this.position.x + dw * dock.left;
		float ny = this.position.y + dh * dock.top;
		float nw = size.x + dw * (dock.right-dock.left);
		float nh = size.y + dh * (dock.bottom-dock.top);
		position(nx, ny);
		size(nw, nh);
	}
	//=============================================================================================
	
}
//*************************************************************************************************
